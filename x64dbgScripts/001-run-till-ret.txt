
//
// An example script
//

ClearLog
log "script starting"
bc

// Set breakpoint at VirtualAlloc and start execution
bp VirtualAlloc
run

// Remove the breakpoint and modify the protection PAGE_READWRITE
bpc VirtualAlloc
log "Current protection requested : {r9d}"
mov r9d, 4
run

// Give execute access to the page and continue execution
setpagerights rip, ExecuteRead
sestep  // swallow exception
rtr

// Dump the code and continue execution 
log "The intercepted code, generated by our AsmJit code, is {eax}"
run
